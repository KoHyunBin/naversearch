<!DOCTYPE html>
<!-- /naversearch/src/main/webapp/naverapi.html -->
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<script type="text/javascript"
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js">
</script>
<script>
$(function(){
    $("#XML2").click(function(){
       $.ajax({
          type : "POST",
          url : "naverxml.jsp",
          data : {"data":$("#data2").val(),
                      "display":$("#display2").val(),
                      "start":$("#start2").val()},
          success : function(data) { //XML 형식으로 데이터 수신
             console.log(data)
             let html = "";
             html += "<table border='1'>"
                             + "<tr><td colspan='7' align='center'>전체 조회 건수:"
                             + $(data).find("total").text()+"</td></tr>";
             let num = 1;
             $(data).find("item").each(function(){
                let title = $(this).find("title").text();
                let link = $(this).find("originallink").text();
                let description = $(this).find("description").text();
                let lastBuilDate = $(this).find("lastBuilDate").text();
                let postdate = $(this).find("pubDate").text();
                html += "<tr><td>" + num + "</td><td>" + title
                         + "</td><td><a href='" + link + "'>" + link + "</a></td><td>"
                         + description + "</td><td>" + postdate + "</td></tr>";
                num ++;
             })
             html +="</table>";
             $("#result2").html(html);
          }
       })
    })
 })
$(function(){
    $("#json2").click(function(){
       $.ajax({
          type : "POST",
          url : "naverjson.jsp",
          data : {"data":$("#data2").val(),
                      "display":$("#display2").val(),
                      "start":$("#start2").val()},
          success : function(data) { //전체 조회된 건수
             console.log(data);
             let json = eval("("+data+")");
             let total = json.total;
             let html = "";
             let num = 1;
             html += "<table border='1'>"
                             + "<tr><td colspan='7' align='center'>전체 조회 건수:"+total+"</td></tr>";
             $.each(json.items,function(i,item){
            	html +="<tr><td>"+num+"</td><td><a href='"+item.link+"'>"+item.title+"</a>"
            	+ "</td><td>" + item.link
            	+ "</td><td>" + item.description
            	+ "</td><td>" + item.pubDate+"</td></tr>";
            	num++;
             })
             $("#result2").html(html);
          }
       });
    });
 }) 
</script>
</head>
<body>
<h1>네이버 뉴스 검색</h1>
검색 갯수 :
	<select id="display2">
		<option>10</option>
		<option>20</option>
		<option>50</option>
	</select>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
검색 페이지 : 
	<select id="start2">
		<option>1</option>
		<option>2</option>
		<option>3</option>
	</select>
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
검색어 : <input type="text" id="data2" value="부천">
<input type="button" id="XML2" value="xml 방식">
<input type="button" id="json2" value="json 방식">
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<div id="result2"></div>
</body>
</html>